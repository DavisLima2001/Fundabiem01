
@{
    ViewBag.Title = "Estudio";
    Layout = "~/Views/Shared/_Layout2.cshtml";
}


<div class="card">
    <div class="card-header text-center">
        <!-- Agrega la clase "text-center" -->
        <h1>ESTUDIO SOCIOECONOMICO</h1>
    </div>
    <div class="card-body">
        @*<div class="row">*@
        <div id="Botones" class="form-group">

            <div class="row" id="miFila">
                <div class="col-md-3 col-12 ">
                    <!-- Agrega un formulario o campos de entrada aquí -->
                    <!-- Botón Guardar -->
                    <button type="button" class="btn btn-primary" onclick="Guardar()"> <i class="fas fa-save"></i> Guardar</button>
                    <br />
                    <br />

                </div>
                <br />
                <div class="col-md-3 col-12 ">
                    <!-- Botón Actualizar -->
                    <button type="button" class="btn btn-success" onclick="Actualizar()"> <i class="fas fa-sync"></i> Actualizar</button>
                    <br />
                    <br />

                </div>
                <br />
                <div class="col-md-3  col-12 ">

                    <!-- Botón limpiar -->
                    <button type="button" class="btn btn-success" onclick="LimpiarFormulario()"> <i class="fas fa-eraser"></i> Limpiar</button>
                    <br />
                    <br />

                </div>
                <div class="col-md-2 col-12 ">

                    <!-- Botón imprimir -->
                    <button type="button" class="btn btn-dark" onclick="print()"> <i class="fas fa-print"></i> imprimir</button>
                    <br />
                    <br />

                </div>

            </div>

            <div class="row" id="miFila">
                <div class="col-md-3 col-12 ">
                    <label for="txtApellido1" class="col-form-label">1er. Apellido: </label>
                    <input type="text" class="form-control" id="txtPrimerApellidob" autocomplete="off">
                </div>
                <div class="col-md-3 col-12 ">
                    <label for="txtNombre1" class="col-form-label">1er. Nombre: </label>
                    <input type="text" class="form-control" id="txtPrimerNombreb" autocomplete="off">
                </div>
                <div class="col-md-3 col-12 ">


                    <!-- Botón asignar -->
                    <button type="button" class="btn btn-info" id="btBuscar"> <i class="fas fa-check"></i> Asignar Usuario</button>

                    <br />
                    <br />
                    <br />
                </div>

                <div class="col-md-3 col-12 d-flex flex-row align-items-center">
                    <!-- Botón Buscar -->
                    <button type="button" class="btn btn-info" id="btBuscar2">
                        <i class="fas fa-search"></i> Buscar
                    </button>

                    <!-- Espacio entre el botón y el input -->
                    <div style="margin-left: 10px;"></div>

                    <!-- Input a la derecha del botón -->

                    <input type="text" class="form-control" id="txtIdFichaEstudio" placeholder="No. Estudio" autocomplete="off">
                </div>

            </div>
            <input id="txtIdUsuario" placeholder="Ingrese Id del Usuario" type="hidden">

        </div>
        <br />
        <div class="row" id="Fila">
            <div class="col-md-6 col-12 d-flex align-items-center">

                <label for="txtRegMedicoNo" class="col-md-2 col-form-label">Reg.Medico No.:</label>
                <input type="text" class="form-control" id="txtRegMedicoNo" autocomplete="off">

            </div>
            <div class="col-md-6 col-12 d-flex align-items-center ">
                <label for="txtRegSocialNo" class="col-md-2 col-form-label">Reg.Social No:</label>
                <input type="text" class="form-control" id="txtRegSocialNo" autocomplete="off">
            </div>

        </div>
        <!-- Segunda fila: 2 columnas -->
        <div class="row" id="Fila">
            <div class="col-md-6 col-12 d-flex align-items-center ">
                <label for="txtFechaDeIngreso" class="col-md-2 col-form-label">Fecha de Ingreso:</label>
                <input type="text" class="form-control" id="txtFechaDeIngreso" placeholder="yyyy/mm/dd" autocomplete="off">
            </div>
            <div class="col-md-6 col-12 d-flex align-items-center ">
                <label for="txtFechaEntrevistas" class="col-md-2 col-form-label">Fecha Entrevistas:</label>
                <input type="text" class="form-control" id="txtFechaEntrevistas" placeholder="yyyy/mm/dd" autocomplete="off">
            </div>
        </div>
       
        <!-- Tercera fila: 1 columnas -->
        <div class="row" id="Fila">
            <div class="col-md-12 col-12 d-flex align-items-center">
                <label for="txtTSentrevisto" class="col-md-2 col-form-label">T.S entrevisto:</label>
                <input type="text" class="form-control" id="txtTSentrevisto" autocomplete="off">
            </div>
        </div>
        <div class="row" id="Fila">
            <div class="col-md-12 col-12 d-flex align-items-center">
                <label for="txtEvaluo" class="col-form-label">Evaluo: </label>
                <input type="text" class="form-control" id="txtEvaluo" autocomplete="off">
            </div>
        </div>
        <!-- Cuarta fila: 2 columnas -->
        <div class="row" id="Fila">
            <div class="col-md-3 col-12 d-flex align-items-center ">
                <label for="txtNombreUsuario" class="col-md-2 col-form-label">Nombre Usuario: </label>
                <input type="text" class="form-control" id="txt1oAPELLIDO" autocomplete="off" readonly>
            </div>
            <div class="col-md-3 col-12 d-flex align-items-center ">
                <label for="txtNombreUsuario" class="col-md-2 col-form-label"></label>
                <input type="text" class="form-control" id="txtNOMBRE" autocomplete="off" readonly>
            </div>
            <div class="col-md-6 col-12 d-flex align-items-center">
                <label for="txtEscalaridad" class="col-form-label">Escalaridad: </label>
                <input type="text" class="form-control" id="txtEscalaridad" autocomplete="off">
            </div>

        </div>

        <!-- Quinta fila: 2 columnas -->
        <div class="row" id="Fila">
            <div class="col-md-6 col-12 d-flex align-items-center">
                <label for="txtDireccion" class="col-form-label">Dirección: </label>
                <input type="text" class="form-control" id="txtDireccion" autocomplete="off" readonly>
            </div>
            <div class="col-md-6  col-12 d-flex align-items-center">
                <label for="txtTel" class="col-form-label">Tel.: </label>
                <input type="text" class="form-control" id="txtTel" autocomplete="off" readonly>
            </div>
        </div>

        <!-- Sexta fila: 1 columnas -->
        <div class="row" id="Fila">

            <div class="col-md-12 col-12 d-flex align-items-center">
                <label for="txtPermanente" class="col-form-label">Permanente: </label>
                <input type="text" class="form-control" id="txtPermanente" autocomplete="off">
            </div>
        </div>
        <div class="row" id="Fila">

            <div class="col-md-12 col-12 d-flex align-items-center">
                <label for="txtTemporal" class="col-form-label">Temporal: </label>
                <input type="text" class="form-control" id="txtTemporal" autocomplete="off">
            </div>
        </div>

        <!-- septima fila: 3 columnas -->
        <div class="row" id="Fila">

            <div class="col-md-4 col-12 d-flex align-items-center">
                <label for="txtEdad" class="col-md-2 col-form-label">edad : </label>
                <input type="text" class="form-control" id="txtEdad" autocomplete="off" readonly>
            </div>
            <div class="col-md-2 col-12 d-flex align-items-center">
                <label for="txtSexo" class="col-md-2 col-form-label">Sexo : </label>
                <input type="text" class="form-control" id="txtSexo" autocomplete="off" readonly>
            </div>
            <div class="col-md-6 col-12 d-flex align-items-center">
                <label for="txtLugarFechaNacimiento" class="col-md-2 col-form-label">Lugar/Fecha de nacimiento : </label>
                <input type="text" class="form-control" id="txtLugarFechaNacimiento" autocomplete="off" readonly>
            </div>
        </div>
        <!-- optaba fila: 2 columnas -->
        <div class="row" id="Fila">

            <div class="col-md-6 col-12 d-flex align-items-center">
                <label for="txtAtendidoPor" class="col-md-2 col-form-label">Atendido por: </label>
                <input type="text" class="form-control" id="txtAtendidoPor" autocomplete="off">
            </div>
            <div class="col-md-6 col-12 d-flex align-items-center">
                <label for="txtRelgion" class="col-form-label">Religión : </label>
                <input type="text" class="form-control" id="txtReligion" autocomplete="off">
            </div>
        </div>
        <!-- novena fila: 1 columnas -->
        <div class="row" id="Fila">

            <div class="col-md-12 col-12 d-flex align-items-center">
                <label for="txtDxMedico" class="col-form-label">Dx.Medico: </label>
                <input type="text" class="form-control" id="txtDxMedico" autocomplete="off">
            </div>

        </div>
        <div class="row" id="Fila">

            <div class="col-md-12 col-12 d-flex align-items-center">
                <label for="txtServicio" class="col-form-label">Servicio: </label>
                <input type="text" class="form-control" id="txtServicio" autocomplete="off">
            </div>

        </div>
        <!-- decima fila: 8 columnas -->
        <div class="row" id="Fila">
            <div class="col-md-1 col-12 d-flex align-items-center">
                <label for="txtOtros" class="col-form-label">FT:</label>
            </div>
            <div class="col-md-1 col-12">
                <input type="text" class="form-control" id="txtFT" autocomplete="off">
            </div>

            <div class="col-md-1 col-12 d-flex align-items-center">
                <label for="txtOtros" class="col-form-label">Pscina:</label>
            </div>
            <div class="col-md-1 col-12">
                <input type="text" class="form-control" id="txtPscina" autocomplete="off">
            </div>

            <div class="col-md-1 col-12 d-flex align-items-center">
                <label for="txtOtros" class="col-form-label">T.O:</label>
            </div>
            <div class="col-md-1 col-12">
                <input type="text" class="form-control" id="txtTO" autocomplete="off">
            </div>

            <div class="col-md-1 col-12 d-flex align-items-center">
                <label for="txtOtros" class="col-form-label">T.L:</label>
            </div>
            <div class="col-md-1 col-12">
                <input type="text" class="form-control" id="txtTL" autocomplete="off">
            </div>

            <div class="col-md-1 col-12 d-flex align-items-center">
                <label for="txtOtros" class="col-form-label">E.E:</label>
            </div>
            <div class="col-md-1 col-12">
                <input type="text" class="form-control" id="txtEE" autocomplete="off">
            </div>

            <div class="col-md-1 col-12 d-flex align-items-center">
                <label for="txtOtros" class="col-form-label">Escuela:</label>
            </div>
            <div class="col-md-1 col-12">
                <input type="text" class="form-control" id="txtEscuela" autocomplete="off">
            </div>

            <div class="col-md-1 col-12 d-flex align-items-center">
                <label for="txtOtros" class="col-form-label">Psicol:</label>
            </div>
            <div class="col-md-1 col-12">
                <input type="text" class="form-control" id="txtPsicol" autocomplete="off">
            </div>

            <div class="col-md-1 col-12 d-flex align-items-center">
                <label for="txtOtros" class="col-md-2 col-form-label">ind. Casa:</label>
            </div>
            <div class="col-md-1 col-12">
                <input type="text" class="form-control" id="txtIndCasa" autocomplete="off">
            </div>
        </div>

        <!--  fila 11 : 1 columnas -->
        <div class="row" id="Fila">

            <div class="col-md-12 col-12  d-flex align-items-center">
                <label for="txtOtros" class="col-md-2 col-form-label">Motivo de solicitud : </label>

                <input type="text" class="form-control" id="txtMotivodeSolicitud" autocomplete="off">
            </div>

        </div>
        @*</div>*@


        <div class="row" id="Fila">
            <br />
            <br />
            <br />
            <div class="col-md-4 col-12 d-flex align-items-center">
                <button id="BotonTramiento" type="button" class="btn btn-primary" onclick="abrilModal(null)"> <i class="fas fa-save"></i> AGREGAR FAMILIAR</button>
            </div>
            <div class="col-md-8 col-12 d-flex align-items-center">
                <label for="txtOtros" class="col-md-2 col-form-label" id="Evoluciones">GRUPO FAMILIAR  </label>
            </div>
        </div>
        <hr />
        <div class="row" id="Fila">
            <table id="GrupoFamiliar" class="display  cell-border" style="width:100%">
                <thead>

                    <tr>
                        <th>Nombre</th>
                        <th>E. CIVIL</th>
                        @*<th>Duracion</th>*@
                        <th>RELACION</th>
                        <th>ED</th>
                        <th>ESCOLARIDAD</th>
                        <th>OCUPACION</th>
                        <th>SALARIO</th>
                        <th></th>
                    </tr>
                </thead>


                <tbody>
                </tbody>
            </table>
        </div>

        <Br />
        <br />

        <div class="row" id="Fila">
            <div class="col-md-3 col-12 d-flex align-items-center">

                <label for="txtParedes" class="col-form-label">Paredes: </label>
                <input type="text" class="form-control" id="txtParedes" autocomplete="off">

            </div>
            <div class="col-md-3 col-12 d-flex align-items-center ">
                <label for="txtTecho" class="col-form-label">Techo: </label>
                <input type="text" class="form-control" id="txtTecho" autocomplete="off">
            </div>
            <div class="col-md-3 col-12 d-flex align-items-center ">
                <label for="txtPisos" class="col-form-label">Pisos: </label>
                <input type="text" class="form-control" id="txtPisos" autocomplete="off">
            </div>
            <div class="col-md-3 col-12 d-flex align-items-center ">
                <label for="txtNoHabitaciones" class="col-md-2 col-form-label">No. Habitaciones: </label>
                <input type="text" class="form-control" id="txtNoHabitaciones" autocomplete="off">
            </div>

        </div>
        <!-- Segunda fila: 2 columnas -->
        <div class="row" id="Fila">
            <div class="col-md-3 col-12 d-flex align-items-center ">
                <label for="txtAgua" class="col-form-label">Agua: </label>
                <input type="text" class="form-control" id="txtAgua" autocomplete="off">
            </div>
            <div class="col-md-3 col-12 d-flex align-items-center ">
                <label for="txtLuzElectrica" class="col-md-2 col-form-label">Luz  Electrica: </label>
                <input type="text" class="form-control" id="txtLuzElectrica" autocomplete="off">
            </div>
            <div class="col-md-3 col-12 d-flex align-items-center ">
                <label for="ServicioSanitario" class="col-md-2 col-form-label">Servicio Sanitario: </label>
                <input type="text" class="form-control" id="txtServicioSanitario" autocomplete="off">
            </div>
            <div class="col-md-3 col-12 d-flex align-items-center ">
                <label for="txtLetrina" class="col-form-label">Letrina: </label>
                <input type="text" class="form-control" id="txtLetrina" autocomplete="off">
            </div>
        </div>

        <!-- Tercera fila: 1 columnas -->
        <div class="row" id="Fila">
            <div class="col-md-4 col-12 d-flex align-items-center">
                <label for="txtOtros" class="col-form-label">Otros: </label>
                <input type="text" class="form-control" id="txtOtros" autocomplete="off">
            </div>
            <div class="col-md-5 col-12 d-flex align-items-center">
                <label for="txtLetrina" class="col-md-2 col-form-label">La cocina esta fuera del dormitorio: </label>
                <input type="text" class="form-control" id="txtCocinaFuera" autocomplete="off">
            </div>
            <div class="col-md-3 col-12 d-flex align-items-center">
                <label for="txtEspropio" class="col-form-label">Espropio: </label>
                <input type="text" class="form-control" id="txtEspropio" autocomplete="off">
            </div>
        </div>
        <div class="row" id="Fila">
            <div class="col-md-3 col-12 d-flex align-items-center">
                <label for="txtPrestado" class="col-form-label">Prestado: </label>
                <input type="text" class="form-control" id="txtPrestado" autocomplete="off">
            </div>
            <div class="col-md-3 col-12 d-flex align-items-center">
                <label for="txtAlquila" class="col-form-label">Alquila: </label>
                <input type="text" class="form-control" id="txtAlquila" autocomplete="off">
            </div>
            <div class="col-md-3 col-12 d-flex align-items-center">
                <label for="txtOtros" class="col-form-label">Otros: </label>
                <input type="text" class="form-control" id="txtOtros2" autocomplete="off">
            </div>
            <div class="col-md-3 col-12 d-flex align-items-center">
                <label for="txtPagoMensual" class="col-md-2 col-form-label">Pago Mensual: </label>
                <input type="text" class="form-control" id="txtPagoMensual" autocomplete="off">
            </div>
        </div>
        <!-- Quinta fila: 2 columnas -->
        <div class="row" id="Fila">
            <div class="col-md-12 col-12 d-flex align-items-center">
                <label for="txtDiagnosticoSocial" class="col-md-2 col-form-label">DIAGNOSTICO SOCIAL : </label>
                <input type="text" class="form-control" id="txtDiagnosticoSocial" autocomplete="off">
            </div>
        </div>

        <!-- Sexta fila: 1 columnas -->
        <div class="row" id="Fila">

            <div class="col-md-12 col-12 d-flex align-items-center">
                <label for="txtOpinioTS" class="col-md-2 col-form-label">OPINIO TS.: </label>
                <input type="text" class="form-control" id="txtOpinioTS" autocomplete="off">
            </div>
        </div>
        <!-- Sexta fila: 1 columnas -->
        <div class="row" id="Fila">

            <div class="col-md-12 col-12 d-flex align-items-center">
                <label for="txtObsevaciones" class="col-form-label">OBSERVACIONES.: </label>
                <input type="text" class="form-control" id="txtObsevaciones" autocomplete="off">
            </div>
        </div>

    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="FormUsuario" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" data-bs-backdrop="static">
    <div class="modal-dialog modal-dialog-centered">
        <!-- Cambio la clase modal-dialog y agrego modal-dialog-centered para centrar el modal -->
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Asignacion de medicamentos</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="col-sm-12">
                    <!-- Utilizo una sola columna para contenido -->
                    <input type="hidden" class="form-control" id="txtIdGrupoFamiliar" value="0">
                    <input type="hidden" class="form-control" id="IdFichaEstudioEconomico2">

                    <label for="Tratamiento" class="form-label">Nombre</label>
                    <input type="text" class="form-control" id="txtNombre" autocomplete="off" style="border-color:black">
                    <br />
                    <label for="Duracion" class="form-label">E Civil</label>
                    <input type="text" class="form-control" id="txtEcivil" autocomplete="off" style="border-color:black">
                    <br />
                    <label for="Duracion" class="form-label">Relacion</label>
                    <input type="text" class="form-control" id="txtRelacion" autocomplete="off" style="border-color:black">
                    <br />
                    <label for="no" class="form-label">Edad</label>
                    <input type="text" class="form-control" id="txtEdad2" autocomplete="off" style="border-color:black">
                    <br />
                    <label for="ft" class="form-label">Escolaridad</label>
                    <input type="text" class="form-control" id="txtEscolaridad" autocomplete="off" style="border-color:black">
                    <br />
                    <label for="ft" class="form-label">Ocupacion</label>
                    <input type="text" class="form-control" id="txtOcupacion" autocomplete="off" style="border-color:black">
                    <br />
                    <label for="ft" class="form-label">Salario</label>
                    <input type="text" class="form-control" id="txtSalario" autocomplete="off" style="border-color:black">
                   

                </div>
                <div class="row mt-2">
                    <div class="col-12" style="background-color:chartreuse">
                        <div id="mensajeError" class="alert alert-danger" role="alert">
                            A simple danger alert—check it out!
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="background-color:lavender">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <span>X </span>
                    Cerrar
                </button>
                <button type="button" class="btn btn-primary" onclick="Guardar2()" id="boton">
                    <span class="fas fa-download"></span>
                    Guardar
                </button>
            </div>
        </div>
    </div>
</div>
@section scripts{

    <script>

        var tabladata;
        var filaSeleccionada;
          
        $("#txtFechaDeIngreso").datepicker({
            dateFormat: 'yy/mm/dd',
            monthNames: ['enero', 'febrero', 'marzo', 'abril', 'mayo', 'junio', 'julio', 'agosto', 'septiembre', 'octubre', 'noviembre', 'diciembre'],
            monthNamesShort: ['ene', 'feb', 'mar', 'abr', 'may', 'jun', 'jul', 'ago', 'sep', 'oct', 'nov', 'dic'],
            dayNames: ['domingo', 'lunes', 'martes', 'miércoles', 'jueves', 'viernes', 'sábado'],
            dayNamesShort: ['dom', 'lun', 'mar', 'mié', 'jue', 'vie', 'sáb'],
            dayNamesMin: ['D', 'L', 'M', 'Mi', 'J', 'V', 'S'],


        }).datepicker('setDate', new Date());
        $("#txtFechaEntrevistas").datepicker({
            dateFormat: 'yy/mm/dd',
            monthNames: ['enero', 'febrero', 'marzo', 'abril', 'mayo', 'junio', 'julio', 'agosto', 'septiembre', 'octubre', 'noviembre', 'diciembre'],
            monthNamesShort: ['ene', 'feb', 'mar', 'abr', 'may', 'jun', 'jul', 'ago', 'sep', 'oct', 'nov', 'dic'],
            dayNames: ['domingo', 'lunes', 'martes', 'miércoles', 'jueves', 'viernes', 'sábado'],
            dayNamesShort: ['dom', 'lun', 'mar', 'mié', 'jue', 'vie', 'sáb'],
            dayNamesMin: ['D', 'L', 'M', 'Mi', 'J', 'V', 'S'],


        }).datepicker('setDate', new Date());

        function LimpiarFormulario() {
            $("#txtIdFichaEstudio").val(0); 
            $("#IdFichaEstudioEconomico2").val(0);
            $("#txtIdUsuario").val(0);
            $("#txtNOMBRE").val("");
            $("#txt1oAPELLIDO").val("");
            $("#txtSexo").val("");
            $("#txtEdad").val("");
            $("#txtDireccion").val(" ");
            $("#txtTel").val(" ");
            $("#txtLugarFechaNacimiento").val("");
            $("#txtRegMedicoNo").val("");
            $("#txtRegSocialNo").val("");
            $("#txtFechaDeIngreso").val("");
            $("#txtFechaEntrevistas").val("");
            $("#txtTSentrevisto").val("");
            $("#txtEvaluo").val("");
            $("#txtEscalaridad").val("");
            $("#txtPermanente").val("");
            $("#txtTemporal").val("");
            $("#txtAtendidoPor").val("");
            $("#txtReligion").val("");
            $("#txtDxMedico").val("");
            $("#txtServicio").val("");
            $("#txtFT").val("");
            $("#txtPscina").val("");
            $("#txtTO").val("");
            $("#txtTL").val("");
            $("#txtEE").val("");
            $("#txtEscuela").val("");
            $("#txtIndCasa").val("");
            $("#txtPsicol").val("");
            $("#txtMotivodeSolicitud").val("");
            $("#txtParedes").val("");
            $("#txtTecho").val("");
            $("#txtPisos").val("");
            $("#txtNoHabitaciones").val("");
            $("#txtAgua").val("");
            $("#txtLuzElectrica").val("");
            $("#txtServicioSanitario").val("");
            $("#txtLetrina").val("");
            $("#txtOtros").val("");
            $("#txtCocinaFuera").val("");
            $("#txtEspropio").val("");
            $("#txtPrestado").val("");
            $("#txtAlquila").val("");
            $("#txtOtros2").val("");
            $("#txtPagoMensual").val("");
            $("#txtDiagnosticoSocial").val("");
            $("#txtOpinioTS").val("");
            $("#txtObsevaciones").val("");
                mostrar();
           

        }


        $("#GrupoFamiliar tbody").on("click touchstart", '.btn-eliminar', function (event) {

            event.stopPropagation();
            event.preventDefault();


            var clickedElement = $(event.target);
            var isLi = clickedElement.closest("li").length > 0;

            var filaSeleccionada = isLi ? clickedElement.closest("li") : clickedElement.closest("tr");
            var data = tabladata.row(filaSeleccionada).data();

            swal({
                title: "Esta Seguro?",
                text: "¿Desea eliminar a la pesona del grupo familiar?",
                type: "warning",
                showCancelButton: true,
                confirmButtonClass: "btn-primary",
                confirmButtonText: "Si",
                cancelButtonText: "No",
                closeOnConfirm: true
            },
                function () {

                      jQuery.ajax({
                   url: '@Url.Action("EliminarGrupoFamiñiar", "Estudio")',
                          type: "POST",
                          data: JSON.stringify({ id: data.IdGrupoFamiliar }),
                   dataType: "json",
                   contentType: "application/json; charset=utf-8",
                   success: function (data) {

                       debugger;

                      if (data.resultado) {

                          tabladata.row(filaSeleccionada).remove().draw();
                     } else {

                           swal("No se pudo eliminar", data.mensaje, "error")
                       }
                  },
                   error: function (error) {
                   console.log(error)
                    }
               });




                });

            console.log(data)


        })

        $("#GrupoFamiliar tbody").on("click touchstart", '.btn-editar', function (event) {
            event.stopPropagation();
            event.preventDefault();


            var clickedElement = $(event.target);
            var isLi = clickedElement.closest("li").length > 0;






            var filaSeleccionada1 = isLi ? clickedElement.closest("li") : clickedElement.closest("tr");


            var data = tabladata.row(filaSeleccionada1).data();
            console.log(data);
            abrilModal(data);




        })


         function Guardar2() {
            var GrupoFamiliar = {
                //// txtIdGrupoFamiliar  txtNombre txtEcivil txtRelacion txtEdad txtEscolaridad txtSalario txtOcupacion txtFICHA_ESTUDIO_ECONOMICO

                IdGrupoFamiliar: $("#txtIdGrupoFamiliar").val(),
                nombre: $("#txtNombre").val(),
                eCivil: $("#txtEcivil").val(),
                relacion: $("#txtRelacion").val(),
                edad: $("#txtEdad2").val(),
                escolaridad: $("#txtEscolaridad").val(),
                ocupacion: $("#txtOcupacion").val(),
                salario: $("#txtSalario").val(),
                IdFichaEstudioEconomico: $("#IdFichaEstudioEconomico2").val(),
            }
              jQuery.ajax({
                url: '@Url.Action("GuardarGrupoFamiliar", "Estudio")',
                type: "POST",
                  data: JSON.stringify({ objeto: GrupoFamiliar }),
                dataType: "json",
                contentType: "application/json; charset=utf-8",
                success: function (data) {

                    $(".modal-body").LoadingOverlay("hide");



                    if (GrupoFamiliar.IdGrupoFamiliar == 0) {

                        if (data.resultado != 0) {
                            debugger;
                            // Set the values of txt1oAPELLIDO and txtNOMBRE
                            $("#txt1oAPELLIDO").val($("#txtPrimerApellidob").val());
                            $("#txtNOMBRE").val($("#txtPrimerNombreb").val());

                            // para poder saber cual es el id usuario
                            $("#btBuscar2").click();
                            //Tratamiento.IdTablaTratamiento = data.resultado;
                            //tabladata.row.add(Tratamiento).draw(false);
                            $("#FormUsuario").modal("hide");

                        } else {
                            $("#mensajeError").text(data.mensaje);
                            $("#mensajeError").show();
                        }


                    } else {

                        if (data.resultado) {
                            $("#btBuscar2").click();;
                            $("#FormUsuario").modal("hide");

                        } else {
                            $("#mensajeError").text(data.mensaje);
                            $("#mensajeError").show();
                        }
                    }

                  },
                  error: function (error) {
                      $(".modal-body").LoadingOverlay("hide");
                      $("#mensajeError").text("Error Ajax");
                      $("#mensajeError").show();
                  },
                  beforeSend: function () {
                      $(".modal-body").LoadingOverlay("show", {
                          imageResizeFactor: 2,
                          text: "Cargando...",
                          size: 14
                      })
                  }

            });

        }





         function mostrar() {

        var nuevaurl = '@Url.Action("ListarGrpoFamiliar", "Estudio")' +
            "?IdFichaEstudioEconomico=" + $("#txtIdFichaEstudio").val() 

            tabladata.ajax.url(nuevaurl).load();

        }

         var Url = '@Url.Action("ListarGrpoFamiliar", "Estudio")' +
             "?IdFichaEstudioEconomico=" + $("#txtIdFichaEstudio").val() ,


             tabladata = $("#GrupoFamiliar").DataTable({
            "paging": false,
            "searching": false, // Esto desactiva el buscador
            responsive: true,
                 ordering: false,
                 "info": false,
                        "ajax": {
                            url:Url,
                            type: "GET",
                            dataType: "json"
                        },
                        "columns":
                        [

                                { "data": "nombre" },
                                { "data": "eCivil" },
                            /*    { "data": "duracion" },*/

                                { "data": "relacion" },
                                { "data": "edad" },
                                { "data": "escolaridad" },
                                { "data": "ocupacion" },
                                { "data": "salario" },
                            {
                                "defaultContent": ' <button type="button" class="btn btn-outline-secondary btn-sm btn-editar"><i class="fas fa-pen"></i></button>' +
                                    ' <button type="button" class="btn btn-outline-dark btn-sm ms-2 btn-eliminar"><i class="fas fa-trash"></i></button>',
                                "orderable": false,
                                "searchable": false,
                                "width": "90px"
                            }
                        ],
                        "language": {
                            "url": "https://cdn.datatables.net/plug-ins/1.11.3/i18n/es_es.json"
            },
            retrieve: true,
            paging: false
        });
            $.fn.dataTable.ext.errMode = 'throw';


        function abrilModal(json) {
            // txtIdGrupoFamiliar  txtNombre txtEcivil txtRelacion txtEdad txtEscolaridad txtSalario txtOcupacion
            $("#txtIdGrupoFamiliar").val(0);
            $("#txtNombre").val(" ");
            $("#txtEcivil").val(" ");
            $("#txtRelacion").val(" ");
            $("#txtEdad2").val(0);
            $("#txtEscolaridad").val(" ");
            $("#txtSalario").val(0);
            $("#txtOcupacion").val(" ");
            $("#mensajeError").hide();


            debugger;






            if (json != null) {

                $("#txtIdGrupoFamiliar").val(json.IdGrupoFamiliar);
                $("#txtNombre").val(json.nombre);
                $("#txtEcivil").val(json.eCivil);
                $("#txtRelacion").val(json.relacion);
                $("#txtEdad2").val(json.edad);
                $("#txtft").val(json.ft);
                $("#txtEscolaridad").val(json.escolaridad);
                $("#txtOcupacion").val(json.ocupacion);
                $("#txtSalario").val(json.salario);

                    $("#IdFichaEstudioEconomico2").val(json.IdFichaEstudioEconomico);
            }

            $("#FormUsuario").modal("show");
        }



        $(function () {
            $("#btBuscar2").on("click", function () {


                        //txtIdFichaEstudio
                jQuery.ajax({
                    url: '@Url.Action("VistaFichaEstudio", "Estudio")' +
                        "?IdFichaEstudioEconomico=" + $("#txtIdFichaEstudio").val() ,
                    type: "GET",
                    dataType: "json",
                    contentType: "application/json; charset=utf-8",
                    success: function (data) {
                        debugger;

                        var ob = data.resultado;
                        $("#txtIdFichaEstudio").val(ob.IdFichaEstudioEconomico),
                        $("#txtIdUsuario").val(ob.IdUsuario),
                            $("#txtNOMBRE").val(ob.PrimerNombre),
                            $("#txt1oAPELLIDO").val(ob.PrimerApellido),
                            $("#txtSexo").val(ob.Sexo),
                            $("#txtEdad").val(ob.Edad),
                            $("#txtDireccion").val(ob.Direccion2),
                            $("#txtTel").val(ob.Telefono),
                            $("#txtLugarFechaNacimiento").val(ob.FechaNacimiento)
                            $("#txtRegMedicoNo").val(ob.regMedicoNo),
                            $("#txtRegSocialNo").val(ob.regSocialNo),
                            $("#txtFechaDeIngreso").val(ob.fechaIngreso),
                            $("#txtFechaEntrevistas").val(ob.fechaEntrevista),
                            $("#txtTSentrevisto").val(ob.tsEntrevisto),
                            $("#txtEvaluo").val(ob.evaluo),
                            $("#txtEscalaridad").val(ob.escolaridad),
                            $("#txtPermanente").val(ob.permanente),
                            $("#txtTemporal").val(ob.temporal),
                            $("#txtAtendidoPor").val(ob.atendidoPor),
                            $("#txtReligion").val(ob.religion),
                            $("#txtDxMedico").val(ob.dxMedico),
                            $("#txtServicio").val(ob.servicio),
                            $("#txtFT").val(ob.ft),
                            $("#txtPscina").val(ob.Pscina),
                            $("#txtTO").val(ob.t_o),
                            $("#txtTL").val(ob.tl),
                            $("#txtEE").val(ob.ee),
                            $("#txtEscuela").val(ob.escuela),
                            $("#txtIndCasa").val(ob.indCasa), 
                                $("#txtPsicol").val(ob.pSicol),
                            $("#txtMotivodeSolicitud").val(ob.motivoSolicitud),
                            $("#txtParedes").val(ob.paredes),
                            $("#txtTecho").val(ob.techo),
                            $("#txtPisos").val(ob.pisos),
                            $("#txtNoHabitaciones").val(ob.noHabitaciones),
                            $("#txtAgua").val(ob.agua),
                            $("#txtLuzElectrica").val(ob.luzeElectrica),
                            $("#txtServicioSanitario").val(ob.servicioSanitario),
                            $("#txtLetrina").val(ob.letrina),
                            $("#txtOtros").val(ob.otros1),
                            $("#txtCocinaFuera").val(ob.cosinaFuera),
                                $("#txtEspropio").val(ob.esPropia),
                            $("#txtPrestado").val(ob.prestada),
                            $("#txtAlquila").val(ob.alquila),
                            $("#txtOtros2").val(ob.otros2),
                            $("#txtPagoMensual").val(ob.pagoMensual),
                            $("#txtDiagnosticoSocial").val(ob.diagnosticoSocial),
                            $("#txtOpinioTS").val(ob.opinionTS),
                            $("#txtObsevaciones").val(ob.observaciones)

                        mostrar();
                        cambiar();


                    }

                });

            });

        }
            )


     function Actualizar() {

         var FichaEstudio = {
            IdFichaEstudioEconomico: $("#txtIdFichaEstudio").val(),
           IdUsuario: $("#txtIdUsuario").val(),
           regMedicoNo: $("#txtRegMedicoNo").val(),
           regSocialNo: $("#txtRegSocialNo").val(),
           fechaIngreso: $("#txtFechaDeIngreso").val(),
           fechaEntrevista: $("#txtFechaEntrevistas").val(),
           tsEntrevisto: $("#txtTSentrevisto").val(),
           evaluo: $("#txtEvaluo").val(),

           escolaridad: $("#txtEscalaridad").val(),

           permanente: $("#txtPermanente").val(),
           temporal: $("#txtTemporal").val(),

           atendidoPor: $("#txtAtendidoPor").val(),
           religion: $("#txtReligion").val(),
           dxMedico: $("#txtDxMedico").val(),
           servicio: $("#txtServicio").val(),
           ft: $("#txtFT").val(),
           Pscina: $("#txtPscina").val(),
           t_o: $("#txtTO").val(),
           tl: $("#txtTL").val(),
           ee: $("#txtEE").val(),
             escuela: $("#txtEscuela").val(), 
             pSicol: $("#txtPsicol").val(),
           indCasa: $("#txtIndCasa").val(),
           motivoSolicitud: $("#txtMotivodeSolicitud").val(),
           paredes: $("#txtParedes").val(),
           techo: $("#txtTecho").val(),
           pisos: $("#txtPisos").val(),
           noHabitaciones: $("#txtNoHabitaciones").val(),
           agua: $("#txtAgua").val(),
           luzeElectrica: $("#txtLuzElectrica").val(),
           servicioSanitario: $("#txtServicioSanitario").val(),
           letrina: $("#txtLetrina").val(),
           otros1: $("#txtOtros").val(),
           cosinaFuera: $("#txtCocinaFuera").val(),
           esPropia: $("#txtEspropio").val(),
           prestada: $("#txtPrestado").val(),
           alquila: $("#txtAlquila").val(),
             otros2: $("#txtOtros2").val(),
           pagoMensual: $("#txtPagoMensual").val(),
           diagnosticoSocial: $("#txtDiagnosticoSocial").val(),
           opinionTS: $("#txtOpinioTS").val(),
           observaciones: $("#txtObsevaciones").val()

    }

    jQuery.ajax({
        url: '@Url.Action("ActualizarFichaEstudioSociEconomico", "Estudio")',
        type: "POST",
        data: JSON.stringify({ objeto: FichaEstudio }),
        dataType: "json",
        contentType: "application/json; charset=utf-8",
        success: function (data) {
            $(".modal-body").LoadingOverlay("hide");
            debugger;

            if (data.resultado != 0) {


                cambiar();
                // Set the values of txt1oAPELLIDO and txtNOMBRE
                $("#txt1oAPELLIDO").val($("#txtPrimerApellidob").val());
                $("#txtNOMBRE").val($("#txtPrimerNombreb").val());

                //para poder saber cual es el id usuario
                $("#btBuscar2").click();


                // La inserción fue exitosa.
                // Puedes realizar cualquier acción adicional que desees aquí.
                // Por ejemplo, borrar los campos del formulario o mostrar un mensaje de éxito.
                swal("Los cambios se guardaron con exito", "success");

            } else {
                swal("Error", data.mensaje, "error")
            }
        },
        error: function (error) {
            $(".modal-body").LoadingOverlay("hide");
            $("#mensajeError").text("Error Ajax");
            $("#mensajeError").show();
        },
        beforeSend: function () {
            $(".modal-body").LoadingOverlay("show", {
                imageResizeFactor: 2,
                text: "Cargando...",
                size: 14
            });
        }
    });
        }





                  $(function () {
            $("#btBuscar").on("click", function () {

                IdUsuario: $("#txtIdUsuario").val()

                jQuery.ajax({
                    url: '@Url.Action("VistaUsuario", "FichaUsuario")' +
                        "?PrimerApellido=" + $("#txtPrimerApellidob").val() +
                        "&PrimerNombre=" + $("#txtPrimerNombreb").val(),
                    type: "GET",
                    dataType: "json",
                    contentType: "application/json; charset=utf-8",
                    success: function (data) {
                        debugger;

                        if (data && data.resultado) {
                            var ob = data.resultado;
                            var sexoValue = ob.Sexo;
                            var textoSexo = (sexoValue === "F") ? "Femenino" : (sexoValue === "M") ? "Masculino" : "";

                            $("#txtIdUsuario").val(ob.IdUsuario),
                                $("#txtNOMBRE").val(ob.PrimerNombre),
                                $("#txt1oAPELLIDO").val(ob.PrimerApellido),
                                $("#txtSexo").val(textoSexo),
                                $("#txtEdad").val(ob.Edad),
                                $("#txtDireccion").val(ob.Direccion2),
                                $("#txtTel").val(ob.Telefono),
                                $("#txtLugarFechaNacimiento").val(ob.FechaNacimiento)
                        } else {
                            // Mostrar mensaje si no se encontraron datos
                            swal("No se encontraron datos", "No hay resultados para la búsqueda.", "warning");
                        }



                    },
                    error: function () {
                        // Manejar errores de la solicitud AJAX
                        swal("No se encontraron datos", "Busca el usuario correcto.", "warning");
                    }

                });

            });

        }
        )


        /// txtIdFichaEstudio
            function cambiar() {

                var ci = document.getElementById('txtIdFichaEstudio').value;
                document.getElementById('IdFichaEstudioEconomico2').value = ci;

            }


  function Guardar() {
    debugger;
    var FichaEstudio = {
        IdUsuario: $("#txtIdUsuario").val(),
        regMedicoNo: $("#txtRegMedicoNo").val(),
        regSocialNo: $("#txtRegSocialNo").val(),
        fechaIngreso: $("#txtFechaDeIngreso").val(),
        fechaEntrevista: $("#txtFechaEntrevistas").val(),
        tsEntrevisto: $("#txtTSentrevisto").val(),
        evaluo:  $("#txtEvaluo").val(),

        escolaridad:  $("#txtEscalaridad").val(),

        permanente:  $("#txtPermanente").val(),
        temporal: $("#txtTemporal").val(),

        atendidoPor:  $("#txtAtendidoPor").val(),
        religion: $("#txtReligion").val(),
        dxMedico:  $("#txtDxMedico").val(),
        servicio: $("#txtServicio").val(),
        ft:  $("#txtFT").val(),
        Pscina:  $("#txtPscina").val(),
        t_o:  $("#txtTO").val(),
        tl: $("#txtTL").val(),
        ee:  $("#txtEE").val(),
        escuela:  $("#txtEscuela").val(),
        pSicol: $("#txtPsicol").val(),
        indCasa:  $("#txtIndCasa").val(),
        motivoSolicitud: $("#txtMotivodeSolicitud").val(),
        paredes:  $("#txtParedes").val(),
        techo: $("#txtTecho").val(),
        pisos:  $("#txtPisos").val(),
        noHabitaciones:  $("#txtNoHabitaciones").val(),
        agua: $("#txtAgua").val(),
        luzeElectrica:  $("#txtLuzElectrica").val(),
        servicioSanitario: $("#txtServicioSanitario").val(),
        letrina  :  $("#txtLetrina").val(),
        otros1: $("#txtOtros").val(),
        cosinaFuera: $("#txtCocinaFuera").val(),
        esPropia:  $("#txtEspropio").val(),
        prestada:  $("#txtPrestado").val(),
        alquila:  $("#txtAlquila").val(),
        otros2: $("#txtOtros2").val(),
        pagoMensual:  $("#txtPagoMensual").val(),
        diagnosticoSocial: $("#txtDiagnosticoSocial").val(),
        opinionTS:  $("#txtOpinioTS").val(),
        observaciones: $("#txtObsevaciones").val()


    }

      jQuery.ajax({
          url: '@Url.Action("GuardarFichaEstudiSocioEconomico", "Estudio")',
          type: "POST",
          data: JSON.stringify({ objeto: FichaEstudio }),
          dataType: "json",
          contentType: "application/json; charset=utf-8",
          success: function (data) {
              $(".modal-body").LoadingOverlay("hide");
              debugger;

              if (data.resultado != 0) {
                  cambiar();
                  // Set the values of txt1oAPELLIDO and txtNOMBRE
                  //$("#txtIdFichaEstudio").val(data.resultado);
                  ///// txtIdFichaEstudio
                  ////para poder saber cual es el id usuario
                  //$("#btBuscar2").click();

                  LimpiarFormulario();

                // La inserción fue exitosa.
                // Puedes realizar cualquier acción adicional que desees aquí.
                // Por ejemplo, borrar los campos del formulario o mostrar un mensaje de éxito.
                  swal("Se guardo con exito con el id:"+data.resultado, "success");

            } else {
                swal("Error", data.mensaje, "error")
            }
        },
        error: function (error) {
            $(".modal-body").LoadingOverlay("hide");
            $("#mensajeError").text("Error Ajax");
            $("#mensajeError").show();
        },
        beforeSend: function () {
            $(".modal-body").LoadingOverlay("shsow", {
                imageResizeFactor: 2,
                text: "Cargando...",
                size: 14
            });
        }
    });
        }
    </script>

}


